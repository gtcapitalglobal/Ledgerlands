{
  "query": "-- Criar tabela contractAttachments\nCREATE TABLE IF NOT EXISTS `contractAttachments` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `contractId` int NOT NULL,\n  `fileName` varchar(255) NOT NULL,\n  `fileUrl` text NOT NULL,\n  `fileType` varchar(50) NOT NULL,\n  `fileSize` int,\n  `uploadedAt` timestamp NOT NULL DEFAULT (now()),\n  CONSTRAINT `contractAttachments_id` PRIMARY KEY(`id`)\n);\n\n-- Renomear type para saleType e modificar enum\nALTER TABLE `contracts` CHANGE COLUMN `type` `saleType` enum('CFD','CASH') NOT NULL DEFAULT 'CFD';\n\n-- Modificar installmentAmount e installmentCount para nullable\nALTER TABLE `contracts` MODIFY COLUMN `installmentAmount` decimal(15,2);\nALTER TABLE `contracts` MODIFY COLUMN `installmentCount` int;\n\n-- Adicionar novos campos\nALTER TABLE `contracts` ADD COLUMN IF NOT EXISTS `originType` enum('DIRECT','ASSUMED') NOT NULL DEFAULT 'DIRECT';\nALTER TABLE `contracts` ADD COLUMN IF NOT EXISTS `state` varchar(2) NOT NULL DEFAULT 'FL';\nALTER TABLE `contracts` ADD COLUMN IF NOT EXISTS `closeDate` date;\n\n-- Copiar valores de saleType para originType (assumindo que os dados atuais s達o CFD)\nUPDATE `contracts` SET `originType` = `saleType` WHERE `originType` = 'DIRECT';\n\n-- Atualizar saleType para CFD (todos os contratos existentes s達o CFD)\nUPDATE `contracts` SET `saleType` = 'CFD';\n\n-- Remover attachmentLinks se existir\nALTER TABLE `contracts` DROP COLUMN IF EXISTS `attachmentLinks`;",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 3krvCwj2bCKp68a.921b4e0a8333 --database TnDmUootRUrjFAU3xdbYec --execute -- Criar tabela contractAttachments\nCREATE TABLE IF NOT EXISTS `contractAttachments` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `contractId` int NOT NULL,\n  `fileName` varchar(255) NOT NULL,\n  `fileUrl` text NOT NULL,\n  `fileType` varchar(50) NOT NULL,\n  `fileSize` int,\n  `uploadedAt` timestamp NOT NULL DEFAULT (now()),\n  CONSTRAINT `contractAttachments_id` PRIMARY KEY(`id`)\n);\n\n-- Renomear type para saleType e modificar enum\nALTER TABLE `contracts` CHANGE COLUMN `type` `saleType` enum('CFD','CASH') NOT NULL DEFAULT 'CFD';\n\n-- Modificar installmentAmount e installmentCount para nullable\nALTER TABLE `contracts` MODIFY COLUMN `installmentAmount` decimal(15,2);\nALTER TABLE `contracts` MODIFY COLUMN `installmentCount` int;\n\n-- Adicionar novos campos\nALTER TABLE `contracts` ADD COLUMN IF NOT EXISTS `originType` enum('DIRECT','ASSUMED') NOT NULL DEFAULT 'DIRECT';\nALTER TABLE `contracts` ADD COLUMN IF NOT EXISTS `state` varchar(2) NOT NULL DEFAULT 'FL';\nALTER TABLE `contracts` ADD COLUMN IF NOT EXISTS `closeDate` date;\n\n-- Copiar valores de saleType para originType (assumindo que os dados atuais s達o CFD)\nUPDATE `contracts` SET `originType` = `saleType` WHERE `originType` = 'DIRECT';\n\n-- Atualizar saleType para CFD (todos os contratos existentes s達o CFD)\nUPDATE `contracts` SET `saleType` = 'CFD';\n\n-- Remover attachmentLinks se existir\nALTER TABLE `contracts` DROP COLUMN IF EXISTS `attachmentLinks`;",
  "returncode": 1,
  "logs": [
    "ERROR 1054 (42S22) at line 14: Unknown column 'type' in 'contracts'"
  ]
}